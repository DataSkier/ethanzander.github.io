if (self.CavalryLogger) { CavalryLogger.start_js(["+5fIO"]); }

__d('ReactComposerStatusActions',['ReactComposerStatusActionType','ReactComposerDispatcher','ReactComposerStatusStore'],(function a(b,c,d,e,f,g){c('ReactComposerStatusStore');h.prototype.setMentionsSource=function(i,j){'use strict';var k={composerID:i,type:c('ReactComposerStatusActionType').SET_MENTIONS_SOURCE,mentionsSource:j};c('ReactComposerDispatcher').dispatch(k);};h.prototype.setTypeaheadReporter=function(i,j){'use strict';var k={composerID:i,type:c('ReactComposerStatusActionType').SET_TYPEAHEAD_REPORTER,typeaheadReporter:j};c('ReactComposerDispatcher').dispatch(k);};h.prototype.setEditorState=function(i,j){'use strict';var k={composerID:i,type:c('ReactComposerStatusActionType').SET_EDITOR_STATE,editorState:j};c('ReactComposerDispatcher').dispatch(k);};h.prototype.setOriginalEditorState=function(i,j){'use strict';var k={composerID:i,type:c('ReactComposerStatusActionType').SET_ORIGINAL_EDITOR_STATE,originalEditorState:j};c('ReactComposerDispatcher').dispatch(k);};h.prototype.setMentions=function(i,j){'use strict';var k={composerID:i,type:c('ReactComposerStatusActionType').SET_MENTIONS,mentions:j};c('ReactComposerDispatcher').dispatch(k);};h.prototype.setTextLength=function(i,j){'use strict';c('ReactComposerDispatcher').dispatch({composerID:i,type:c('ReactComposerStatusActionType').SET_TEXT_LENGTH,textLength:j});};function h(){'use strict';}f.exports=new h();}),null);
__d('ReactComposerStatusAttachmentMentionsInput.react',['cx','ReactComposerConfig','ReactComposerContextMixin','ReactComposerEvents','ReactComposerInit','ReactComposerTaggerType','AddEmojiInputContainer','Arbiter','EditorState','MentionsInput.react','ReactComponentWithPureRenderMixin','React','SubscriptionsHandler','XUITypeaheadView.react','joinClasses'],(function a(b,c,d,e,f,g,h){var i=c('AddEmojiInputContainer').addEmojiInput,j=c('React').PropTypes,k=void 0;if(i){k=i(c('MentionsInput.react'));}else k=c('MentionsInput.react');var l=c('React').createClass({displayName:'ReactComposerStatusAttachmentMentionsInput',_subscriptions:undefined,mixins:[c('ReactComponentWithPureRenderMixin'),c('ReactComposerContextMixin')],propTypes:{config:c('ReactComposerConfig'),mentionsSource:j.object,preventFocus:j.bool,typeaheadReporter:j.object,onChange:j.func,onFocus:j.func,onPasteFiles:j.func},componentWillUnmount:function m(){this.props.onBlur&&this.props.onBlur(this.props.editorState);this._subscriptions&&this._subscriptions.release();},componentWillMount:function m(){var n=new (c('SubscriptionsHandler'))();if(!this.props.preventFocus)n.addSubscriptions(c('Arbiter').subscribe([c('ReactComposerEvents').ACTIVATE_ATTACHMENT+this.context.composerID],function(){return this.focus();}.bind(this)));this._subscriptions=n;},render:function m(){var n=this.props.config&&this.props.taggersConfig&&this.props.config.taggersConfig[c('ReactComposerTaggerType').PEOPLE],o=n&&n.typeaheadView?n.typeaheadView:c('XUITypeaheadView.react'),p=n&&n.typeaheadViewProps?n.typeaheadViewProps:{},q=Object.assign({},{typeaheadView:o,typeaheadViewProps:p,selectOnTab:false,spellCheck:true},this.props,{className:c('joinClasses')("_1mwp",this.props.className),editorState:this.props.editorState,onAddMention:this._onAddMention,onShowMentions:this._onShowMentions,onFocus:this._onFocus,onBlur:this._onBlur,onChange:this._onChange,maxResults:10});return c('React').createElement(k,babelHelpers['extends']({ref:'mentionsInput'},q,{webDriverTestID:'status-attachment-mentions-input'}));},focus:function m(){if(!c('ReactComposerInit').isInstanceMounted(this.context.composerID)){c('Arbiter').subscribeOnce([c('ReactComposerEvents').INSTANCE_MOUNTED+this.context.composerID],function(){return this.refs.mentionsInput.focus();}.bind(this));}else this.refs.mentionsInput.focus();},blur:function m(){this.refs.mentionsInput.blur();},_onAddMention:function m(n,o,p){var q=this.props.typeaheadReporter;if(q){q.reportSelect(n.getUniqueID(),n.getType(),o,p.button>=0);q.sessionEnd();q.sessionStart();}},_onShowMentions:function m(n,o){var p=this.props.typeaheadReporter;if(p)p.reportResults(n.map(function(q){return q.getUniqueID();}));},_onFocus:function m(){var n=this.props.typeaheadReporter;if(n)n.sessionStart();this.props.onFocus&&this.props.onFocus();},_onChange:function m(n){this.props.onChange&&this.props.onChange(n);},_onBlur:function m(){this.props.typeaheadReporter&&this.props.typeaheadReporter.sessionEnd();this.props.onBlur&&this.props.onBlur(this.props.editorState);}});f.exports=l;}),null);
__d('ReactComposerStatusAttachmentMentionsInputVariant.react',['cx','ReactComposerActions','ReactComposerAttachmentType','ReactComposerStatusAttachmentMentionsInput.react','AddEmojiToEditorStateContainer','EmojiInputButtonContainer','ReactComposerStickerContainer','Keys','React','UserAgent_DEPRECATED','emptyFunction','joinClasses'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('AddEmojiToEditorStateContainer').addEmojiToEditorState,l=c('EmojiInputButtonContainer').EmojiInputButton,m=c('ReactComposerStickerContainer').ReactComposerStickerComponent;i=babelHelpers.inherits(n,c('React').Component);j=i&&i.prototype;function n(o){j.constructor.call(this,o);this.insertEmoji=function(p){if(k)k(p,this.props.editorState,this.props.onChange);}.bind(this);this.$ReactComposerStatusAttachmentMentionsInputVariant1=function(p){var q=/^image\//;p=p.filter(function(r){return q.test(r.type);});if(p.length>0&&this.props.onPasteFiles){this.props.onPasteFiles(p);return true;}return false;}.bind(this);this.$ReactComposerStatusAttachmentMentionsInputVariant2=function(event,p){var q=c('UserAgent_DEPRECATED').osx()?event.metaKey:event.ctrlKey;if(event.keyCode===c('Keys').RETURN&&q){this.blur();setTimeout(this.props.onPostIntent,0);return true;}return false;}.bind(this);this.$ReactComposerStatusAttachmentMentionsInputVariant3=function(){c('ReactComposerActions').expandSprouts(this.props.compositionID);}.bind(this);}n.prototype.render=function(){var o=this.props.config&&this.props.config.attachmentsConfig[c('ReactComposerAttachmentType').STATUS],p=null;if(this.props.useRichTextEditor){var q=o.richTextEditor;p=c('React').createElement(q,babelHelpers['extends']({},this.props,{className:c('joinClasses')(this.props.className,"_3w8y"+(!!l?' '+"_21mu":'')),canAttachVideo:false,canAttachPhoto:false,canAttachEmbed:false,onSave:c('emptyFunction'),spellCheck:true,autoCorrect:false,handlePastedFiles:this.$ReactComposerStatusAttachmentMentionsInputVariant1,handleContentReturn:this.$ReactComposerStatusAttachmentMentionsInputVariant2,ref:'mentionsInput'}));}else p=c('React').createElement(c('ReactComposerStatusAttachmentMentionsInput.react'),babelHelpers['extends']({},this.props,{className:c('joinClasses')(this.props.className,(this.props.isSelectedAttachmentActive?"_1mwq":'')+(this.props.config&&this.props.config.showExpandedComposer?' '+"_4c_p":'')+(o&&o.showProfilePic?' '+"_5bu_":'')+(this.props.isPosting?' '+"_1udp":'')+(this.props.shouldUseLargeText?' '+"_17nh":'')+(o&&o.largeTextThreshold?' '+"_34nd":'')+(!!l?' '+"_21mu":'')+(this.props.sticker&&this.props.sticker.stickerID?' '+"_hjn":'')),ref:'mentionsInput',readOnly:this.props.isPosting,editorState:this.props.editorState,mentionsSource:this.props.mentionsSource,typeaheadReporter:this.props.typeaheadReporter,handlePastedFiles:this.$ReactComposerStatusAttachmentMentionsInputVariant1,handleContentReturn:this.$ReactComposerStatusAttachmentMentionsInputVariant2}));var r=null;if(l){var s="_3nc-",t="_3nc_",u="_5zq9";r=c('React').createElement(l,{buttonClassName:s,iconActiveClassName:u,iconClassName:t,onSelect:this.insertEmoji,onClick:this.$ReactComposerStatusAttachmentMentionsInputVariant3});}var v=null;if(m)v=c('React').createElement(m,{sticker:this.props.sticker,composerID:this.props.compositionID});if(r||v)p=c('React').createElement('div',{className:"_3nd0"},v,p,r);return p;};n.prototype.blur=function(){this.refs.mentionsInput.blur();};n.prototype.focus=function(){this.refs.mentionsInput.focus();};f.exports=n;}),null);
__d('ReactComposerStatusAttachmentMentionsInputContainer.react',['ReactComposerActions','ReactComposerAttachmentStore','ReactComposerAttachmentType','ReactComposerConfig','ReactComposerContextMixin','ReactComposerEmojiUtils','ReactComposerEvents','ReactComposerMediaUploadStore','ReactComposerMinutiaeAttachmentStore','ReactComposerPropsAndStoreBasedStateMixin','ReactComposerStatusActions','ReactComposerStatusAttachmentMentionsInputVariant.react','ReactComposerStatusStore','ReactComposerStore','ReactComposerScrapedAttachmentStore','ReactComposerTaggerStore','ReactComposerTaggerType','EditorState','LitestandStoryInsertionStatus','ReactComponentWithPureRenderMixin','ReactComposerHandleUnsavedChanges','ReactComposerInputDecorator','ReactComposerStatusUtils','React','UnicodeUtils','Arbiter','ifRequired'],(function a(b,c,d,e,f,g){var h=c('ReactComposerEmojiUtils').getReactComposerInputDecorator,i=c('React').PropTypes,j=function l(m,n){var o=c('ReactComposerAttachmentStore').getSelectedAttachmentID(m);if(o===c('ReactComposerAttachmentType').LIVE_VIDEO)return false;var p=n&&n.attachmentsConfig[c('ReactComposerAttachmentType').STATUS],q=c('ReactComposerTaggerStore').hasMarkdown(m);return !!(p&&p.richTextEditor&&!q);},k=c('React').createClass({displayName:'ComposerStatusAttachmentMentionsInputContainer',_rerenderSubscription:undefined,mixins:[c('ReactComponentWithPureRenderMixin'),c('ReactComposerContextMixin'),c('ReactComposerPropsAndStoreBasedStateMixin')(c('ReactComposerAttachmentStore'),c('ReactComposerMediaUploadStore'),c('ReactComposerMinutiaeAttachmentStore'),c('ReactComposerScrapedAttachmentStore'),c('ReactComposerStatusStore'),c('ReactComposerStore'),c('ReactComposerTaggerStore'))],propTypes:{config:c('ReactComposerConfig'),mentionsEnabled:i.bool,mentionsSource:i.object,onChange:i.func,onFocus:i.func,onPasteFiles:i.func,handlePastedText:i.func},getDefaultProps:function l(){return {mentionsEnabled:true};},getInitialState:function l(){return {isFocused:false};},statics:{calculateState:function l(m,n){var o=c('ReactComposerStatusStore').getEditorState(m),p=n.config&&n.config.attachmentsConfig[c('ReactComposerAttachmentType').STATUS],q=false,r=c('ReactComposerStatusStore').getTextLength(m),s=c('ReactComposerAttachmentStore').isSelectedAttachmentActive(m),t=c('ReactComposerAttachmentStore').getSelectedAttachmentID(m);if(p&&p.largeTextThreshold&&c('ReactComposerMediaUploadStore').getUploadsCount(m)===0&&!c('ReactComposerScrapedAttachmentStore').hasAttachment(m)&&!c('ReactComposerTaggerStore').hasExplicitLocation(m)&&!c('ReactComposerTaggerStore').hasMarkdown(m)&&c('ReactComposerMinutiaeAttachmentStore').getMarkup(m)===null&&t!==c('ReactComposerAttachmentType').SELL){if(!r&&o){var u=o.getCurrentContent();r=c('UnicodeUtils').strlen(u.getPlainText());}var v=n.config.attachmentsConfig[c('ReactComposerAttachmentType').STATUS].placeholderText;if(v&&v.length<=p.LargePlaceholderTextThreshold&&r===0&&s||r!==0&&r<=p.largeTextThreshold)q=true;c('ifRequired')('ReactComposerFormattedTextStore',function(z){if(z.getSelectedIndex(m)>=0)q=true;});}var w=c('ReactComposerInputDecorator').NONE;if(n.mentionsEnabled)w=p&&p.richTextEditor?c('ReactComposerInputDecorator').RICH_TEXT:c('ReactComposerInputDecorator').MENTIONS;var x=h(w,q&&!j(m,n.config)?28:16),y;if(o){if(o.getDecorator()!==x){y=c('EditorState').set(o,{decorator:x});c('ReactComposerStatusActions').setEditorState(m,y);}else y=o;}else{y=c('EditorState').createEmpty(x);c('ReactComposerStatusActions').setEditorState(m,y);}return {editorState:y,isSelectedAttachmentActive:c('ReactComposerAttachmentStore').isSelectedAttachmentActive(m),mentionsSource:n.mentionsEnabled?c('ReactComposerStatusStore').getMentionsSource(m):null,posting:c('ReactComposerStore').isPosting(m),typeaheadReporter:c('ReactComposerStatusStore').getTypeaheadReporter(m),shouldUseLargeText:q,selectedSticker:c('ReactComposerTaggerStore').getTaggerData(m,c('ReactComposerTaggerType').STICKER)};}},componentWillMount:function l(){if(this.props.mentionsSource)c('ReactComposerStatusActions').setMentionsSource(this.context.composerID,this.props.mentionsSource);this._storyInsertionBlocker=c('LitestandStoryInsertionStatus').registerBlocker(function(){return c('ReactComposerHandleUnsavedChanges').hasUnsavedChanges(this.context.composerID)||this.state.isFocused;}.bind(this));},componentDidMount:function l(){var m=c('ReactComposerStatusStore').getEditorState(this.context.composerID);if(this.state.editorState!==m){this._pendingEditorStateUpdateFromMount=m;this.setState({editorState:m},function(){this._pendingEditorStateUpdateFromMount=undefined;}.bind(this));}this._rerenderSubscription=c('Arbiter').subscribe(c('ReactComposerEvents').RERENDER_MENTION_INPUT+this.context.composerID,function(){this.setState({editorState:c('ReactComposerStatusStore').getEditorState(this.context.composerID)});}.bind(this));},componentWillReceiveProps:function l(m){if(this.props.mentionsSource!==m.mentionsSource)c('ReactComposerStatusActions').setMentionsSource(this.context.composerID,m.mentionsSource);if(m.editorState===null){var n=c('EditorState').createEmpty(h(c('ReactComposerInputDecorator').MENTIONS));c('ReactComposerStatusActions').setEditorState(this.context.composerID,n);this.setState({editorState:n});}},componentWillUnmount:function l(){this._prefillSubscription&&this._prefillSubscription.unsubscribe();this._prefillSubscription=null;this._storyInsertionBlocker&&this._storyInsertionBlocker.unsubscribe();this._storyInsertionBlocker=null;this._rerenderSubscription&&this._rerenderSubscription.unsubscribe();},_useRichTextEditor:function l(){return j(this.context.composerID,this.props.config);},render:function l(){return c('React').createElement(c('ReactComposerStatusAttachmentMentionsInputVariant.react'),babelHelpers['extends']({},this.props,{compositionID:this.context.composerID,editorState:this.state.editorState,isSelectedAttachmentActive:this.state.isSelectedAttachmentActive,isPosting:this.state.posting,mentionsSource:this.state.mentionsSource,onBlur:this._onBlur,onChange:this._onChange,onFocus:this._onFocus,onPostIntent:this._onPostIntent,ownerID:this.context.actorID,ref:'mentionsInput',shouldUseLargeText:this.state.shouldUseLargeText,typeaheadReporter:this.state.typeaheadReporter,useRichTextEditor:this._useRichTextEditor(),sticker:this.state.selectedSticker}));},focus:function l(){this.refs.mentionsInput.focus();if(this._pendingEditorStateUpdateFromMount!==undefined)this.setState({editorState:this._pendingEditorStateUpdateFromMount},function(){return this.refs.mentionsInput.focus();}.bind(this));},_onFocus:function l(){c('Arbiter').inform(c('ReactComposerEvents').MENTION_INPUT_FOCUS+this.context.composerID);this.setState({isFocused:true});this.props.onFocus&&this.props.onFocus();},_onChange:function l(m){if(this._pendingEditorStateUpdateFromMount!==undefined)return;var n=0;if(m){var o=m.getCurrentContent();n=o?c('UnicodeUtils').strlen(o.getPlainText()):0;if(c('ReactComposerStatusStore').getEditorState(this.context.composerID)!==m){c('ReactComposerStatusActions').setEditorState(this.context.composerID,m);c('ReactComposerStatusActions').setTextLength(this.context.composerID,n);}}this._handleMarkdownChange(m);this.props.onChange&&this.props.onChange(m);this.setState({editorState:m});},_handleMarkdownChange:function l(m){var n=this.props.config?this.props.config.attachmentsConfig[c('ReactComposerAttachmentType').STATUS]:null;c('ReactComposerStatusUtils').handleMarkdownPreview(this.context.composerID,this.context.targetID,n?n.markdownPreviewAttachment:null,m);},_onBlur:function l(m){c('ReactComposerStatusActions').setEditorState(this.context.composerID,m);this.setState({isFocused:false});},_onPostIntent:function l(){c('ReactComposerActions').postIntended(this.context.composerID,{actorID:this.context.actorID,config:this.props.config,targetID:this.context.targetID});}});f.exports=k;}),null);
__d('ReactComposerStatusAttachmentMentionsInputWithTagExpansionContainer.react',['cx','ReactComposerContextMixin','ReactComposerStatusActions','ReactComposerStatusAttachmentMentionsInputContainer.react','DraftEntity','ReactComponentWithPureRenderMixin','React','joinClasses'],(function a(b,c,d,e,f,g,h){var i=c('React').createClass({displayName:'ComposerStatusAttachmentMentionsInputWithTagExpansionContainer',mixins:[c('ReactComponentWithPureRenderMixin'),c('ReactComposerContextMixin')],render:function j(){var k=c('joinClasses')(this.props.className,"_395");return c('React').createElement(c('ReactComposerStatusAttachmentMentionsInputContainer.react'),babelHelpers['extends']({},this.props,{className:k,onChange:this._onChange,ref:'mentionsInput'}));},focus:function j(){this.refs.mentionsInput.focus();},insertEmoji:function j(k){this.refs.mentionsInput.insertEmoji(k);},_onChange:function j(k){c('ReactComposerStatusActions').setMentions(this.context.composerID,this._getMentionsFromEditorState(k));this.props.onChange&&this.props.onChange(k);},_getMentionsFromEditorState:function j(k){var l=k.getCurrentContent(),m={};l.getBlockMap().forEach(function(n){var o=n.getText();n.findEntityRanges(function(){return true;},function(p,q){var r=n.getEntityAt(p);if(!r)return;var s=l.getEntity(r);if(s.getType()!=='MENTION'||s.getData().type!=='user')return;var t=s.getData().id;m[t]={type:'user',uid:t,text:o.slice(p,q),isWeak:s.getData().isWeak};});});return m;}});f.exports=i;}),null);